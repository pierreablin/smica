
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/covfit_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_covfit_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_covfit_example.py:


Simple CovarianceFit Example
============================

.. GENERATED FROM PYTHON SOURCE LINES 6-35

.. code-block:: default

    import numpy as np

    from smica import CovarianceFit
    import matplotlib.pyplot as plt


    rng = np.random.RandomState(0)

    n_bins = 10
    n_sources = 3
    n_channels = 5

    source_powers = 1 + 2 * rng.rand(n_bins, n_sources)
    noise_powers = 0.03 * (1 + rng.rand(n_bins, n_channels))
    mixing = rng.randn(n_channels, n_sources)

    covariances = [np.dot(mixing, p[:, None] * mixing.T) + np.diag(n)
                   for p, n in zip(source_powers, noise_powers)]

    covariances = np.array(covariances)

    covfit = CovarianceFit(n_sources, rng=rng).fit(covariances)

    estimated_powers = covfit.powers_
    estimated_mixing = covfit.A_
    estimated_noise = covfit.sigmas_

    plt.matshow(np.abs(np.linalg.pinv(mixing).dot(estimated_mixing)))
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)


.. _sphx_glr_download_auto_examples_covfit_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: covfit_example.py <covfit_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: covfit_example.ipynb <covfit_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
